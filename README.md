# Provably Fair and Calculator for Mines

This repository provides a provably fair implementation and a calculator for the Mines game. It calculates the multiplier and win chances for all possible combinations of diamonds and mines, ensuring transparency and fairness for players.

## Features
- **Provably Fair Algorithm**: Uses server and client seeds combined with a game ID to generate mine positions in a verifiable and fair manner.
- **Win Chance Calculation**: Computes the probability of winning based on the number of diamonds and mines.
- **Multiplier Calculation**: Determines the payout multiplier for any given combination of diamonds and mines.
- **Comprehensive Table**: Prints a table displaying win chances and multipliers for all valid configurations.

---

## Code Logic Overview

### 1. Generating Mine Positions
The `generateMinesPosition` function ensures that mine positions are determined in a provably fair way:
- **Inputs**:
  - `serverSeed`: A secret key controlled by the server.
  - `clientSeed`: A seed provided by the client.
  - `gameId`: A unique identifier for each game instance.
  - `minesNum`: The number of mines to place.
- **Outputs**:
  - A sorted array of unique positions for mines.
- **Process**:
  - Combines the `clientSeed` and `gameId` to create a unique seed for each game.
  - Uses HMAC with `sha256` for pseudo-random byte generation.
  - Converts the generated bytes into floating-point numbers to determine mine positions.

### 2. Calculating Win Chances
The `calculateWinChance` method computes the probability of winning:
- Iteratively calculates the likelihood of picking safe tiles based on the number of remaining mines and diamonds.

### 3. Calculating Multipliers
The `calculateMultiplier` method computes the payout multiplier:
- Based on the inverse of the calculated win chance and adjusted by the Return to Player (RTP) factor.

### 4. Printing the Table
The `printTable` method displays all possible configurations:
- For each combination of diamonds and mines, it prints the win chance and multiplier in a tabular format.

---

## How to Run

### Prerequisites
- **Node.js**: Ensure that Node.js is installed on your system.

### Steps
1. Clone this repository:
   ```bash
   git clone <repository_url>
   cd <repository_name>
   ```

2. Install dependencies (if any):
   ```bash
   npm install
   ```

3. Run the script:
   ```bash
   npm start
   ```

4. Observe the output:
  A table showing win chances and multipliers for various configurations will be displayed in the terminal.

---

# How It Works

1. The `generateMinesPosition` function generates mine positions based on the seeds and game ID, ensuring fairness.
2. The `MinesGameCalculator` class provides methods to:
   - **Calculate the win chance**: `calculateWinChance`
   - **Calculate the multiplier**: `calculateMultiplier`
   - **Print the table of configurations**: `printTable`

---

### Example Output
```plaintext
Diamond | Bomb | Multiplier | Win Chance
------------------------------------------
      1 |    1 |      1.04x |   96.000000%
      1 |    2 |      1.09x |   92.000000%
      1 |    3 |      1.14x |   88.000000%
      ...
```

---

# Provably Fair Verification

To verify fairness:
1. Combine `serverSeed`, `clientSeed`, and `gameId` as described in the code.
2. Generate the mine positions independently using the same HMAC process.
3. Compare the output with the mine positions provided by the server.

---

## License
This project is open-source and available under the **MIT License**.